<div layout="row" ng-show="member || user.privileges>0" style="height:100%">
  <div id="enablenotifications" ng-show="showNotificationTop()" style="cursor:pointer;position:absolute;z-index:999;width:100%;height:auto;text-align:center;">
		<div style="border-style:solid;border-width:1px;border-top:none;display: inline-block;background-color:orange;">
			<a class="md-caption" ng-click="enableNotifications()">
				You have the notifications turned off, if you want to see the notifications for a better experience, click here.
			</a>
				<md-icon ng-click="closeEnableNotifications()">close</md-icon>
  		</div>
  </div>
  <md-content-flex flex="5" style="background-color:#29b6f6">
  	 <md-list style="height:100%" flex layout="column" layout-align="space-between center">
	  	 <a href="#/user/{{user.id}}" style="margin-top:0px">
	  	 	<ng-letter-avatar data="{{user.name}}" shape="round"></ng-letter-avatar>
	  	 </a>
	      <md-list-item>
	        <md-button class="md-icon-button launch" ng-click="showScreen('chat')">
	          <md-icon>
		    	home
			  </md-icon>
			  <md-tooltip md-direction="right">
			  	Main page
			  </md-tooltip>
	        </md-button>
	      </md-list-item>
	      <md-list-item>
	        <md-button class="md-icon-button launch" ng-click="showNotifications('right')">
	          <md-icon>
		    	notifications
		    </md-icon>
		    <md-tooltip md-direction="right">
		   		Notifications
		   	</md-tooltip>
	        </md-button>
	      </md-list-item>   
	      <md-list-item>
	        <md-button class="md-icon-button launch" ng-click="showScreen('privateMessages')">
	          <md-icon>
		    	messages
		    </md-icon>
		    <md-tooltip md-direction="right">
		   		Messages
		   	</md-tooltip>
	        </md-button>
	      </md-list-item>
	      <md-list-item>
	        <md-button class="md-icon-button launch" ng-click="">
		        <md-icon>
			    	people
			    </md-icon>
			    <md-tooltip md-direction="right">
		        	Members
		    	</md-tooltip>
	        </md-button>
	      </md-list-item>
	      <md-list-item ng-show="participateUser.teamPrivileges>0">
	      <a id="inviteButton" href="#inviteModal">
	        <md-button  class="md-icon-button launch">
		        <md-icon>
			    	person_add
			    </md-icon>
			    <md-tooltip md-direction="right">
		        	Invite people
		    	</md-tooltip>
	        </md-button>
	        </a>
	      </md-list-item>      
	      <md-list-item ng-show="user.privileges>0 || participateUser.teamPrivileges==2">
	       <a ng-href="#/team/{{team.id}}/admin">
	        <md-button class="md-icon-button launch" ng-click="">
	          <md-icon>
		    	build
		    </md-icon>
		    <md-tooltip md-direction="right">
		        	Admin team
		    </md-tooltip>
	        </md-button>
	        </a>
	      </md-list-item>
	      <a href="#/user/{{user.id}}">
	  	 	<ng-letter-avatar data="TRJC" shape="round"></ng-letter-avatar>
	  	 </a>
	    </md-list>
  </md-content-flex>
  <md-content-flex class="md-whiteframe-9dp" flex="20" layout="column" style="position:relative; ">
	   <div style="border-bottom-style:solid;background-color:lightblue;color:white;padding-left:2%;">	   		
	   		<md-menu>
	   			<span style="text-decoration:none;font-weight:bold;cursor:pointer;"ng-click="$mdOpenMenu()">
			        <span ng-bind="team.name"></span>
			        <md-icon md-menu-origin style="color:white">keyboard_arrow_down</md-icon>
			    </span>
			    <md-menu-content width="1">
					<md-menu-item>
						<md-button ng-click="">Preferences</md-button>
					</md-menu-item>
					<md-menu-item ng-show="participateUser.teamPrivileges<2">
						<md-button ng-click="leaveTeam($event)">Sign out of {{team.name}}</md-button>
					</md-menu-item>
				</md-menu-content>
			</md-menu>
	   </div>
	   <md-content-flex layout="row">
		   <div flex>
				
		   </div>
	       <div flex="1">
	        <md-button class="md-icon-button launch" ng-click="newRoom($event)">
		        <md-icon>
			    	add
			    </md-icon>
			    <md-tooltip>
		        	New room
		    	</md-tooltip>
	        </md-button>  
	        </div>
        </md-content-flex>
      <md-content-flex>
      <md-subheader class="md-no-sticky" id="publicroomsbutton">Public rooms ({{publicRooms().length}})</md-subheader>
	  <div id="publicrooms" style="max-height: 15em; overflow-y:auto; overflow-x: hidden;">
	  <md-list-item ng-click="register(room, $event)" ng-repeat="room in publicRooms()">
	    <p>{{ room.name }}</p>
	    <md-icon id="{{room.name}}" ng-show="user.privileges>0 || participateUser.teamPrivileges>0 || room.creator==user.id" ng-click="deleteRoom(room, $event)" aria-label="Delete room" class="md-secondary md-hue-3" style="color: blue;visibility:hidden">clear</md-icon>
	  	<md-divider ng-if="!$last"></md-divider>
	  </md-list-item>
	  </div>
	  <md-subheader class="md-no-sticky" id="privateroomsbutton">Private rooms ({{privateRooms().length}})</md-subheader>
	  <div id="privaterooms" style="max-height: 15em; overflow-y:auto; overflow-x: hidden;">
		  <md-list-item ng-click="register(room, $event)" ng-repeat="room in privateRooms() track by $index" ng-mouseover="showRoomButtons($index)" ng-mouseleave="hideRoomButtons($index)">
			    <p>{{ room.name }}</p>
		   		<md-icon id="{{$index}}"ng-click="deleteRoom(room, $event)" aria-label="Delete room" class="md-secondary md-hue-3" style="color: blue;display:none;" ng-show="user.privileges>0 || participateUser.teamPrivileges>0 || room.creator==user.id">clear</md-icon>
			  	<md-divider ng-if="!$last"></md-divider>
		  </md-list-item>
	  </div>
	  <md-subheader class="md-no-sticky" id="onlinemembersbutton">Online members ({{teamUsers.length}})</md-subheader>
	  <div id ="onlinemembers">
		  <md-list-item class="md-line" ng-repeat="participate in teamUsers">
		        <div class="md-list-item-text">
		          <p>{{findUserById(participate.user).name}}</p>
		        </div>
	      </md-list-item>
      </div>
	  </md-content-flex>  
  </md-content-flex>
  
  <div flex style="position:relative;background-color:#e3f2fd;">
  <div style="text-align:right; position:absolute; right:3%;z-index:1">
  		<input type="text" id="inputsearch" placeholder="Ej: name..." style="display:none">
  		<md-button class="md-icon-button launch" id="search">
			<md-icon>
				search
			</md-icon>
			<md-tooltip>
		    	Search
		   	</md-tooltip>
		</md-button>
		<md-button class="md-icon-button launch" ng-click="">
			<md-icon>
				forum
			</md-icon>
			<md-tooltip>
		    	Mentions
		   	</md-tooltip>
		</md-button>
		<md-button class="md-icon-button launch" ng-mouseover="showMenu()" ng-mouseleave="hideMenu()">
			<md-icon>
				more_vert
			</md-icon>
			<md-tooltip>
		    	Menu
		   	</md-tooltip>
		</md-button>
		<div id="menu" ng-mouseover="showMenu()" ng-mouseleave="hideMenu()" style="text-align:left;display:none;z-index:999;right:0px;background-color:white">
				<ul>
				<li ng-repeat="participate in teamUsers" ng-click="">
		          <p>{{findUserById(participate.user).name}}</p>
		        </li>
	     		 </ul>
		</div>
	</div>
  		<div style="padding:3%;padding-top:4%;">		
  		<div ng-show="screen=='privateMessages'" style="background-color:white">
  			Private Messages
  			<p>Last conversations</p>
  			<md-list-item ng-repeat="user in filterMessagesContacts()" ng-click="showUserMessages(user)">
  				 <md-list-item>
  				 	<img src="http://i.imgur.com/HfLuszJ.jpg" class="md-avatar" alt="{{user.id}}" />
  				 <div class="md-list-item-text">
  				 	{{findUserById(user).name}}
  				 </div>
		       <md-divider ng-if="!$last"></md-divider>
				</md-list-item>
  			</md-list-item>
			<div class="md-block">		
				<form ng-submit="newPrivateMessage()">
					<md-input-container md-no-float>
						<input ng-model="privateMessage" type="text" placeholder="New message" required>
					</md-input-container>
				    <md-autocomplete
				        md-no-cache="noCache"
				        md-selected-item="receiver"
				        md-search-text-change="searchTextChange(searchText)"
				        md-search-text="searchText"
				        md-selected-item-change="selectedItemChange(user)"
				        md-items="user in querySearch(searchText)"
				        md-item-text="user.user"
				        md-min-length="0"
				        placeholder="Select receiver">
				       	<md-item-template>
				        	<span md-highlight-text="searchText" md-highlight-flags="^i">{{findUserById(user.user).name}}</span>
				        </md-item-template>
				        <md-not-found>
				          <span ng-show="searchText==''">
				          		Please, select a member of your team
				          </span>
				          <span ng-hide="searchText==''">
				          		There's no user with the name "{{searchText}}".
				          </span>
				        </md-not-found>
					</md-autocomplete>    
					<md-button ng-disabled="privateMessage=='' || !receiver.id" type="submit" class="md-primary">
						Send
					</md-button>
				</form>
			</div>  			  			
  		</div>
  		
  		<div ng-show="screen=='privateUserMessages'" style="background-color:white">
  			<md-button ng-click="showScreen('privateMessages')" class="md-icon-button" aria-label="Close">
		        <md-icon>close</md-icon>
		     </md-button>
		     {{findUserById(userReceiver).name}}
  			 <div id="chatscroll" style="height: 30em;  overflow: scroll; overflow-x: hidden;">
  			<md-list-item ng-repeat="message in privateMessagesChat()">
					     <md-list-item>
					     <a href="#/user/{{message.transmitter}}">
					     <img src="http://i.imgur.com/HfLuszJ.jpg" class="md-avatar" alt="{{message.user.name}}" />
						      </a>
						      <div class="md-list-item-text">
						         <a style="color:blue">{{message.transmitterName}}</a>
						         <p>
						         	<div ng-bind-html="message.text | colonToSmiley"></div>
						         </p>
						         <div style="color:gray;position:absolute;right:0;top:0;bottom:0;margin:auto" class="md-caption">
						      	{{message.date | timeago}}
						      </div>
						       </div>
						       <md-divider ng-if="!$last"></md-divider>
					      </md-list-item>
			 </md-list-item>
			 </div>
			 <form ng-submit="replyMessage(replyText)">
				 <md-input-container md-no-float>
					<input ng-model="replyText" type="text" placeholder="New message" required>
				</md-input-container>
				<md-button type="submit" class="md-primary">
					Send
				</md-button>
			</form>
  		</div>
  		
  		<div ng-show="screen=='chat'" id="chat" style="position:relative;background-color:white;padding:0" class="md-whiteframe-3dp">
			
			<div id="effect">
			  		<div style="position:relative">
			 			<div style="float:left">Team chat</div>
			 			<div style="float:right">
							 	<input style="display:none" id="filtername" type="text" ng-model="nameFilter">
							 	<input style="display:none" id="filtercontent" type="text" ng-model="contentFilter">
							 	<md-datepicker style="display:none" id="filterdate" ng-model="dateFilter" md-placeholder="Enter date"></md-datepicker>
							 	<md-button ng-click="searchByFilter()" id="searchFilter" style="display:none">Search</md-button>		
							 	<md-button ng-click="resetFilter()" ng-show="chatFilter!=''">Reset</md-button>
		  						<md-menu>
							        <md-button class="md-icon-button" ng-click="$mdOpenMenu()">
							            <md-icon md-menu-origin>search</md-icon>
							        </md-button>
							        <md-menu-content width="1">
							            <md-menu-item>
							                <md-button ng-click="showFilterName()">Name</md-button>
							            </md-menu-item>
							            <md-menu-item>
							                <md-button ng-click="showFilterDate()">Date</md-button>
							            </md-menu-item>
							            <md-menu-item>
							                <md-button ng-click="showFilterContent()">Content</md-button>
							            </md-menu-item>
							        </md-menu-content>
							    </md-menu>
						</div>
				 	</div>
      
			    <div id="globalchatscroll" style="height: 75vh;  overflow: scroll; overflow-x: hidden;">
			    	<md-list-item ng-repeat="message in chatMessages() | filter:filterMessages" style="position:relative">
					     <md-list-item style="position:relative" class="md-line">
					     	<a href="#/user/{{message.user}}">
					     	<img ng-src="http://i.imgur.com/HfLuszJ.jpg" class="md-avatar" alt="{{message.user.name}}" />
								<!-- Has to be fixed, fallback always update in ng-repeat -->
<!-- 						    <img ng-src="http://i.imgur.sdasdacom/HfLuszJ.jpg" onError="this.onerror=null;this.src='http://i.imgur.com/HfLuszJ.jpg';" class="md-avatar" alt="{{message.user.name}}" /> -->     
						     </a>
						      <div class="md-list-item-text">
						        <a href="#/user/{{message.user}}" style="text-decoration:none">{{message.userName}}</a>
						         <p>		
						         	<span class="md-body-2">	
						         	<div ng-bind-html="message.text | emoticons"></div>
						         	</span>
						         </p>
						      </div>
						      <div style="color:gray;position:absolute;right:0;top:0;bottom:0;margin:auto" class="md-caption">
						      	{{message.date | timeago}}
						      </div>
						      <md-divider ng-if="!$last"></md-divider>
					     </md-list-item>
					</md-list-item>			
				</div>
				</div>
			   		<form id="chatform" emoji-form emoji-message="emojiMessage" layout="row" autocomplete="off" ng-submit="sendMessage()" style="margin-bottom:0px;padding:5px;background-color:#f5f5f5">
						<md-button id="emojibtn" title="Send message" class="md-icon-button launch" >
				     		<md-icon>
							tag_faces
						</md-icon>
				     	</md-button>
				     	<textarea id="inputchat" flex style="background:white" ng-model="chatMessage" placeholder="New message" ></textarea>
						<md-button type="submit" title="Send message" class="md-icon-button launch" >
				     		<md-icon>
							send
						</md-icon>
				     	</md-button>												
					</form>
  			</div>
</div>
<md-sidenav class="md-sidenav-right md-whiteframe-z2" md-component-id="right">
      <md-toolbar class="md-theme-light">
        <h1 class="md-toolbar-tools">Notifications</h1>
      </md-toolbar>
      <md-content layout-padding>
      	<div ng-show="user.privileges>0 || participateUser.teamPrivileges>0">
      	User		Team
      		 <md-list-item ng-repeat="request in requests()">
    			<p> {{ findUserById(request.user).name }} </p>
    			<p>{{ request.team}}</p>
    			<md-button class="md-icon-button" ng-click="acceptRequest(request)" title="Accept request" aria-label="Accept">
    				<md-icon>check_circle</md-icon>
    			</md-button>
    			<md-button class="md-icon-button" ng-click="denyRequest(request)" title="Deny request" aria-label="Deny">
    				<md-icon>cancel</md-icon>
    			</md-button>
 			 </md-list-item>
 			 </br>
 			 Room requests
 			 <md-list-item ng-repeat="request in roomRequests()">
    			<p> {{findUserById(request.user).name}} </p>
    			<p>{{request.room}}</p>
    			<md-button class="md-icon-button" ng-click="acceptRoomRequest(request)" title="Accept request" aria-label="Accept">
    				<md-icon>check_circle</md-icon>
    			</md-button>
    			<md-button class="md-icon-button" ng-click="denyRoomRequest(request)" title="Deny request" aria-label="Deny">
    				<md-icon>cancel</md-icon>
    			</md-button>
 			 </md-list-item>
      	</div>
       Room invites
       <md-list-item ng-repeat="invitation in roomInvitations()">
    			<p> {{invitation.user}} </p>
    			<p>{{invitation.room}}</p>
    			<md-button class="md-icon-button" ng-click="acceptRoomInvitation(invitation)" title="Accept invitation" aria-label="Accept">
    				<md-icon>check_circle</md-icon>
    			</md-button>
    			<md-button class="md-icon-button" ng-click="denyRoomInvitation(invitation)" title="Deny invitation" aria-label="Deny">
    				<md-icon>cancel</md-icon>
    			</md-button>
 		</md-list-item>
        <md-button ng-click="close('right')" class="md-primary">
          Close Sidenav Right
        </md-button>
      </md-content>
    </md-sidenav>
     
    <md-sidenav layout="column" class="md-sidenav-left md-whiteframe-z2" md-component-id="left">
		  <md-toolbar class="md-tall md-hue-2">
		    <span flex></span>
		    <div layout="column" class="md-toolbar-tools-bottom inset">
		      <user-avatar>
					<ng-letter-avatar data="{{user.name}}" shape="round"></ng-letter-avatar>
		      </user-avatar>
		      <span></span>
		      <div><span ng-bind="user.name"></span> </div>
		      <div><span ng-bind="user.email"></span></div>
		    </div>
		  </md-toolbar>
		  <md-list>
		    <md-item ng-click="showScreen('privateMessages')">
		        <md-item-content md-ink-ripple layout="row" layout-align="start center">
		          <div class="inset">
		            <ng-md-icon>message</ng-md-icon>
		          </div>
		          <div class="inset">Messages
		          </div>
		        </md-item-content>
		    </md-item>
		    <md-item ng-click="showNotifications('right')">
		        <md-item-content md-ink-ripple layout="row" layout-align="start center">
		          <div class="inset">
		            <ng-md-icon>notifications</ng-md-icon>
		          </div>
		          <div class="inset">Notifications
		          </div>
		        </md-item-content>
		    </md-item>
		    <md-divider></md-divider>
		    <md-subheader>Management</md-subheader>
		    <md-item ng-repeat="item in admin">
		      <a>
		        <md-item-content md-ink-ripple layout="row" layout-align="start center">
		          <div class="inset">
		            <ng-md-icon>{{item.icon}}</ng-md-icon>
		          </div>
		          <div class="inset">{{item.title}}
		          </div>
		        </md-item-content>
		      </a>
		    </md-item>
		  </md-list>
	</md-sidenav>   
</div>
</div>
<div ng-hide="member">
	You don't participate in this team.
</div>
<!-- Modals -->
<!--Invite people-->
<div id="inviteModal">
	<div style="width:100%;text-align: center;"> 
		 <md-button style="background-color:white"class="md-fab close-inviteModal" aria-label="Close">
            <md-icon style="color: #39BEB9;">close</md-icon>
       	 </md-button>
	</div>
	<div class="modal-content">
		Invite people!
		<div>
			<md-input-container>
				<md-icon>email</md-icon>
				<input ng-model="email" type="email" placeholder="Email">
			</md-input-container>
			<md-button class="md-primary" ng-click="sendInvitation(email)">
				Enviar
			</md-button>
		</div>
		<div>
			<form ng-submit="sendInvitationUser(name)">
				<md-input-container>
					<md-icon>person</md-icon>
					<input ng-model="name" type="text" placeholder="Username">
				</md-input-container>
				<md-button class="md-primary" type="submit">
					Enviar
				</md-button>
			</form>
		</div>
	</div>
</div>